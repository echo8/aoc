package com.echo8.aoc2020;

import org.apache.commons.lang3.StringUtils;

import java.util.*;

public class Day20Part2 {
    private static final String INPUT = "Tile 2053:\n" +
            "......#.#.\n" +
            "#....#....\n" +
            "#.#.......\n" +
            ".##.#..#.#\n" +
            ".##...####\n" +
            "#.#....#.#\n" +
            "##.##.#.#.\n" +
            "...##.....\n" +
            "####.##..#\n" +
            "#..##...##\n" +
            "\n" +
            "Tile 1543:\n" +
            ".####.##..\n" +
            ".......#.#\n" +
            "..........\n" +
            "..#.......\n" +
            "#......#..\n" +
            "#....##...\n" +
            "#.#....#..\n" +
            "#..##....#\n" +
            "#.#..#....\n" +
            "#.#...####\n" +
            "\n" +
            "Tile 2441:\n" +
            ".##.#..##.\n" +
            "#..#......\n" +
            "..#...#.##\n" +
            "...#.....#\n" +
            "#..##.....\n" +
            "......##..\n" +
            "###.#....#\n" +
            "##...#.#..\n" +
            "...#...###\n" +
            ".#..#.##.#\n" +
            "\n" +
            "Tile 3733:\n" +
            "..#..#....\n" +
            "..#.#.....\n" +
            "......#.##\n" +
            ".#..#.##.#\n" +
            "..#....#..\n" +
            "......#..#\n" +
            ".###.#....\n" +
            ".#.#..#..#\n" +
            ".#....#...\n" +
            "#..#..##..\n" +
            "\n" +
            "Tile 2237:\n" +
            "###.....#.\n" +
            "#..#.....#\n" +
            "........#.\n" +
            "#.#.......\n" +
            "#........#\n" +
            "##...#...#\n" +
            "..#.......\n" +
            "#.......##\n" +
            "##..#....#\n" +
            "...###...#\n" +
            "\n" +
            "Tile 2203:\n" +
            "##..#....#\n" +
            ".....##...\n" +
            "...#....##\n" +
            ".........#\n" +
            "##....#..#\n" +
            "#.#..#.#..\n" +
            ".......###\n" +
            ".#....#..#\n" +
            "......###.\n" +
            "...#..#.##\n" +
            "\n" +
            "Tile 1783:\n" +
            "#...##..#.\n" +
            "........#.\n" +
            "#..#.###.#\n" +
            "....#.##..\n" +
            "....#....#\n" +
            "..#.#....#\n" +
            ".........#\n" +
            "##.#.....#\n" +
            "#.#.....##\n" +
            "#....#..#.\n" +
            "\n" +
            "Tile 1487:\n" +
            "#.....#...\n" +
            "#..#.#...#\n" +
            "..........\n" +
            ".........#\n" +
            "#.....##.#\n" +
            "....###.##\n" +
            "##...#...#\n" +
            "##......##\n" +
            "........#.\n" +
            "....#####.\n" +
            "\n" +
            "Tile 3209:\n" +
            "...#....##\n" +
            "#...##..#.\n" +
            "..#.....##\n" +
            "#.##...###\n" +
            "...#..##.#\n" +
            "..#..#....\n" +
            "......#.#.\n" +
            "..........\n" +
            ".##...##.#\n" +
            "#..##.####\n" +
            "\n" +
            "Tile 2557:\n" +
            "#......#.#\n" +
            "...#......\n" +
            "##.###.#..\n" +
            ".###....##\n" +
            "#.........\n" +
            "....#.#...\n" +
            ".#..###..#\n" +
            "...#...##.\n" +
            ".#.....#.#\n" +
            ".###.##.#.\n" +
            "\n" +
            "Tile 1009:\n" +
            "###.##....\n" +
            "###.#..#.#\n" +
            "#.#....#..\n" +
            ".....##.##\n" +
            "...#.#....\n" +
            "..#.##.#..\n" +
            "#..##.#.##\n" +
            "#..#......\n" +
            "#..#...#.#\n" +
            "#..#.#..##\n" +
            "\n" +
            "Tile 1361:\n" +
            "#..#..###.\n" +
            "....#...#.\n" +
            "##.#....##\n" +
            "......#..#\n" +
            ".........#\n" +
            "##..##...#\n" +
            "#...##...#\n" +
            "#...#.....\n" +
            "..##....##\n" +
            "#..#..####\n" +
            "\n" +
            "Tile 2767:\n" +
            ".#.###.###\n" +
            "#.#.......\n" +
            "...#...##.\n" +
            "#..#...#..\n" +
            "#.#...#...\n" +
            ".#........\n" +
            "##....#...\n" +
            "#....#.#..\n" +
            "#.......#.\n" +
            "#.#.#..#..\n" +
            "\n" +
            "Tile 1109:\n" +
            ".#..#..#.#\n" +
            ".....#..#.\n" +
            "......#..#\n" +
            "..##...#..\n" +
            "...#.#..##\n" +
            "...#.#..##\n" +
            "......##..\n" +
            "#...#..#..\n" +
            "#...#.....\n" +
            "..#.#.#.#.\n" +
            "\n" +
            "Tile 1493:\n" +
            "###..####.\n" +
            "....##...#\n" +
            "#..#.#....\n" +
            "##.....#..\n" +
            "#..#.#..#.\n" +
            "#.........\n" +
            "#...#.#.#.\n" +
            "#.#..#.#.#\n" +
            "##.....#.#\n" +
            "#.#.#.###.\n" +
            "\n" +
            "Tile 2971:\n" +
            "#####...#.\n" +
            "....#.....\n" +
            "#.......##\n" +
            "..#.#...##\n" +
            "...#.##..#\n" +
            "###.#..###\n" +
            "#......#.#\n" +
            "..........\n" +
            "...#..#...\n" +
            ".....#..##\n" +
            "\n" +
            "Tile 2909:\n" +
            ".######.##\n" +
            "###..#...#\n" +
            "#....###..\n" +
            "#.####...#\n" +
            "..#.##....\n" +
            "#.........\n" +
            "..#.#....#\n" +
            ".#.##.##..\n" +
            "##.###.#.#\n" +
            "...##..#..\n" +
            "\n" +
            "Tile 2551:\n" +
            ".#.##.#.#.\n" +
            "###.#..##.\n" +
            "#.......#.\n" +
            "##.......#\n" +
            "..###.....\n" +
            "#.##..#...\n" +
            "#.##....#.\n" +
            "#......#.#\n" +
            "......#.##\n" +
            "#.#...#..#\n" +
            "\n" +
            "Tile 2917:\n" +
            "..###.##..\n" +
            "..#...#..#\n" +
            "#........#\n" +
            "#....##.##\n" +
            "#.........\n" +
            "...##.....\n" +
            ".###...##.\n" +
            "#.#...##..\n" +
            ".#.#.#.##.\n" +
            ".#.#..####\n" +
            "\n" +
            "Tile 1553:\n" +
            "..##..#..#\n" +
            "#..#...#.#\n" +
            "#.#....#.#\n" +
            "##........\n" +
            ".###...#..\n" +
            "#.##.##.##\n" +
            ".....#..#.\n" +
            "#.....##..\n" +
            ".......#.#\n" +
            "##.#.#.##.\n" +
            "\n" +
            "Tile 2297:\n" +
            ".##.##.#..\n" +
            ".##.#..##.\n" +
            "...#.#.###\n" +
            "...##...##\n" +
            ".#..##..##\n" +
            "##.#......\n" +
            "...#.....#\n" +
            "#.#.#...#.\n" +
            ".#......##\n" +
            "....#.##.#\n" +
            "\n" +
            "Tile 1789:\n" +
            "####....#.\n" +
            "#.#.#..#..\n" +
            "...##.####\n" +
            "##.#.#...#\n" +
            ".###.....#\n" +
            ".#.#...##.\n" +
            "#...##.#..\n" +
            "##...#...#\n" +
            "..#.......\n" +
            "#######...\n" +
            "\n" +
            "Tile 3079:\n" +
            "#.##..#.#.\n" +
            "#........#\n" +
            "..#..#....\n" +
            "..#..###.#\n" +
            ".......#.#\n" +
            "#....#####\n" +
            "#......##.\n" +
            "#..##.#...\n" +
            "#.......#.\n" +
            "###..##.##\n" +
            "\n" +
            "Tile 3037:\n" +
            "..####.###\n" +
            "....##.#..\n" +
            ".......##.\n" +
            "....#...#.\n" +
            "..#.#.....\n" +
            ".#......##\n" +
            "##....##..\n" +
            "#..#.#.#..\n" +
            "##......##\n" +
            "###..###..\n" +
            "\n" +
            "Tile 2677:\n" +
            "##.#..#...\n" +
            ".#........\n" +
            "..###..#.#\n" +
            "..##.....#\n" +
            ".##....#.#\n" +
            "#.#...#..#\n" +
            "......#.##\n" +
            ".......#.#\n" +
            "..........\n" +
            "#.#.#..###\n" +
            "\n" +
            "Tile 1129:\n" +
            ".##.#.#.##\n" +
            ".........#\n" +
            "#.##.#....\n" +
            ".#...##..#\n" +
            ".#...#...#\n" +
            "..#..#.#..\n" +
            "##..#....#\n" +
            "##........\n" +
            "..#.##.###\n" +
            "##..#.####\n" +
            "\n" +
            "Tile 2647:\n" +
            ".......#..\n" +
            "#........#\n" +
            ".....#.#..\n" +
            ".......##.\n" +
            "##..#.....\n" +
            ".#.###..#.\n" +
            "#....#.##.\n" +
            "#.#....#..\n" +
            "#.#..#...#\n" +
            "..##.###.#\n" +
            "\n" +
            "Tile 2531:\n" +
            "#.#.##..##\n" +
            "##..#...#.\n" +
            "..#.......\n" +
            "##.......#\n" +
            "..........\n" +
            ".....#...#\n" +
            "#..###...#\n" +
            "#........#\n" +
            "#.........\n" +
            ".####..##.\n" +
            "\n" +
            "Tile 1663:\n" +
            ".#.#..#...\n" +
            "..#...#...\n" +
            "##...##.#.\n" +
            "...#...#..\n" +
            ".##....#..\n" +
            "#........#\n" +
            "...#...#..\n" +
            "##....#..#\n" +
            "#.....#...\n" +
            ".####.##..\n" +
            "\n" +
            "Tile 1193:\n" +
            "#......##.\n" +
            "..#.#.###.\n" +
            "#..#.....#\n" +
            "#.##.....#\n" +
            ".....#..##\n" +
            "....#.#..#\n" +
            "#..#.....#\n" +
            "..........\n" +
            "...###....\n" +
            "#..#.#.###\n" +
            "\n" +
            "Tile 2477:\n" +
            ".#...#.##.\n" +
            "#....##..#\n" +
            "#.##.#...#\n" +
            "##..#.....\n" +
            ".........#\n" +
            "..#..#...#\n" +
            ".##...#.##\n" +
            "#.###.....\n" +
            "#..##.....\n" +
            "..#.##.#.#\n" +
            "\n" +
            "Tile 2083:\n" +
            ".#.#.#.#..\n" +
            "###.#.....\n" +
            ".....#..##\n" +
            "...#.#....\n" +
            "#.......#.\n" +
            ".#.###....\n" +
            "#.#.#.....\n" +
            ".##..#.#.#\n" +
            "#.##.....#\n" +
            "..##.#.##.\n" +
            "\n" +
            "Tile 2897:\n" +
            "###.####..\n" +
            "..##....##\n" +
            "###...#...\n" +
            ".......#..\n" +
            "#..#.#..#.\n" +
            ".....###..\n" +
            "......##..\n" +
            "....##..#.\n" +
            ".#...##..#\n" +
            "#.....#..#\n" +
            "\n" +
            "Tile 3797:\n" +
            "#.....#...\n" +
            "..#.####.#\n" +
            "#....#.#..\n" +
            "#.....#.##\n" +
            "##..#.....\n" +
            "#....#..##\n" +
            "...#...#.#\n" +
            ".#....####\n" +
            "##.##.###.\n" +
            "###.#.#...\n" +
            "\n" +
            "Tile 2087:\n" +
            "#####....#\n" +
            "..##...##.\n" +
            "...#......\n" +
            ".##......#\n" +
            "#..#....#.\n" +
            ".#..#....#\n" +
            "..##......\n" +
            "#........#\n" +
            "#.......#.\n" +
            "#.#.##...#\n" +
            "\n" +
            "Tile 2447:\n" +
            "#.##....#.\n" +
            "##........\n" +
            "##........\n" +
            "#.#...#..#\n" +
            "##.#...#..\n" +
            "#..#..##.#\n" +
            "#........#\n" +
            "........#.\n" +
            "#...#....#\n" +
            "#.....#.##\n" +
            "\n" +
            "Tile 1511:\n" +
            "#...#####.\n" +
            "..#.......\n" +
            ".........#\n" +
            "..#......#\n" +
            "###.......\n" +
            ".....#..##\n" +
            "#..#.....#\n" +
            "#.##.#....\n" +
            "......#..#\n" +
            "###.#.#.##\n" +
            "\n" +
            "Tile 1249:\n" +
            "#.#..##...\n" +
            "#...#.#.#.\n" +
            "......#..#\n" +
            "#....##...\n" +
            "....#.##..\n" +
            ".#..##...#\n" +
            "#....###..\n" +
            "#....#....\n" +
            ".....#...#\n" +
            "...###.##.\n" +
            "\n" +
            "Tile 2741:\n" +
            "###..#..#.\n" +
            "#.##.#...#\n" +
            "#...#....#\n" +
            ".....#...#\n" +
            "#.....#.#.\n" +
            "#.##.#...#\n" +
            "#.#..#...#\n" +
            "......#.#.\n" +
            "#...#..#..\n" +
            "..####.#..\n" +
            "\n" +
            "Tile 3607:\n" +
            "#.#####..#\n" +
            "#..#.#.#.#\n" +
            ".......##.\n" +
            "#........#\n" +
            "#.#..#....\n" +
            "#..##.####\n" +
            "...#..#.#.\n" +
            "........##\n" +
            "..#...#.#.\n" +
            "...#..#..#\n" +
            "\n" +
            "Tile 3877:\n" +
            "###..##...\n" +
            "##...#....\n" +
            "#.........\n" +
            "........##\n" +
            "#....#...#\n" +
            "#...#....#\n" +
            ".....#....\n" +
            "...#...#.#\n" +
            "#..#.#...#\n" +
            ".##...###.\n" +
            "\n" +
            "Tile 1277:\n" +
            "..#....#.#\n" +
            "####..#...\n" +
            "#.........\n" +
            "..........\n" +
            "#...#..##.\n" +
            "...#.#...#\n" +
            "#........#\n" +
            "....#.....\n" +
            "...#..#..#\n" +
            "##.#....##\n" +
            "\n" +
            "Tile 3491:\n" +
            "..#...##..\n" +
            ".........#\n" +
            "#.........\n" +
            "...#......\n" +
            "...#..#.##\n" +
            "#...##....\n" +
            "#....#.#..\n" +
            "#....##...\n" +
            "..#.#..#.#\n" +
            "#.#.#.#.#.\n" +
            "\n" +
            "Tile 2011:\n" +
            "..##...##.\n" +
            "....#.#..#\n" +
            "#..#....##\n" +
            "..........\n" +
            "..........\n" +
            ".....#...#\n" +
            "#..#.#...#\n" +
            "........##\n" +
            ".#.......#\n" +
            "##.......#\n" +
            "\n" +
            "Tile 1087:\n" +
            "#.#.#.#.#.\n" +
            "..#..#..##\n" +
            "#.###.....\n" +
            "#...#..#.#\n" +
            "#....#...#\n" +
            "#....#...#\n" +
            "..##..#.##\n" +
            "#...##....\n" +
            "##........\n" +
            "#......##.\n" +
            "\n" +
            "Tile 3307:\n" +
            "#..##..#.#\n" +
            "...#######\n" +
            "#......###\n" +
            "..#......#\n" +
            "#....##..#\n" +
            ".#.#.#...#\n" +
            "#........#\n" +
            "#.......##\n" +
            "..#..#...#\n" +
            "#.#..##.#.\n" +
            "\n" +
            "Tile 1949:\n" +
            "#.###..##.\n" +
            "#.#......#\n" +
            "#....#.##.\n" +
            "##......#.\n" +
            "#.......##\n" +
            "#.##.#...#\n" +
            ".##....#..\n" +
            "..........\n" +
            "...###....\n" +
            "..#..##..#\n" +
            "\n" +
            "Tile 1061:\n" +
            "...#..#..#\n" +
            "#.....#..#\n" +
            "##.#....##\n" +
            ".#....#..#\n" +
            "..........\n" +
            "#.......##\n" +
            ".#.#.....#\n" +
            "..........\n" +
            "#.#...#.#.\n" +
            "........#.\n" +
            "\n" +
            "Tile 1429:\n" +
            "##.#####..\n" +
            ".#........\n" +
            "#....#....\n" +
            "...#......\n" +
            "#........#\n" +
            "##.....#.#\n" +
            "....##.#..\n" +
            "....#..##.\n" +
            "#...#....#\n" +
            "###.#.##.#\n" +
            "\n" +
            "Tile 2221:\n" +
            "###.#.....\n" +
            "#.......#.\n" +
            "....##.#.#\n" +
            "........##\n" +
            "..#..#....\n" +
            "..###....#\n" +
            "#........#\n" +
            "##.#.#....\n" +
            "#...#...##\n" +
            "##.######.\n" +
            "\n" +
            "Tile 1117:\n" +
            "..#.##.#.#\n" +
            "##.......#\n" +
            "..#.#.....\n" +
            ".##......#\n" +
            ".##..#....\n" +
            ".........#\n" +
            "..#.......\n" +
            "##.#.#.#.#\n" +
            "#.#.......\n" +
            "#.#..#...#\n" +
            "\n" +
            "Tile 1571:\n" +
            "..##.##..#\n" +
            "...#...#.#\n" +
            "#.##......\n" +
            "#..#......\n" +
            "..#..#...#\n" +
            "#.......##\n" +
            "...##....#\n" +
            "..#.#....#\n" +
            "#.#..#..##\n" +
            ".##..#.#..\n" +
            "\n" +
            "Tile 2969:\n" +
            ".##..#..#.\n" +
            "..........\n" +
            "#......#..\n" +
            "#...#....#\n" +
            "..........\n" +
            "..##.#.###\n" +
            ".....#....\n" +
            ".......#.#\n" +
            "####..#.#.\n" +
            "..##..#...\n" +
            "\n" +
            "Tile 2713:\n" +
            "####.##.#.\n" +
            "#.##.#.#..\n" +
            "#...##....\n" +
            "#......#..\n" +
            "#.##.#....\n" +
            "#.........\n" +
            "..##...#.#\n" +
            "#...#.#.#.\n" +
            "#.......##\n" +
            "..####..##\n" +
            "\n" +
            "Tile 3121:\n" +
            "....#.##..\n" +
            "..#......#\n" +
            "..#..##...\n" +
            "#.#......#\n" +
            "#....#..##\n" +
            "....##...#\n" +
            "#..#.#....\n" +
            "#.....#..#\n" +
            "..#...#.#.\n" +
            ".#..####.#\n" +
            "\n" +
            "Tile 3673:\n" +
            ".#.##..###\n" +
            "..#.#.....\n" +
            "...#..#..#\n" +
            "..........\n" +
            ".##....###\n" +
            "#..#...#..\n" +
            "#..##..#..\n" +
            "#...#.....\n" +
            "##.#..#..#\n" +
            "....##.###\n" +
            "\n" +
            "Tile 2683:\n" +
            "..#...#.##\n" +
            "..#..##.##\n" +
            "###..#....\n" +
            "###..#..##\n" +
            ".......#..\n" +
            "..##.....#\n" +
            "#.....#..#\n" +
            "#.###.#.#.\n" +
            "#.#.#.###.\n" +
            "..#.#...#.\n" +
            "\n" +
            "Tile 2617:\n" +
            ".#...#....\n" +
            ".......###\n" +
            ".##..#....\n" +
            "..#..###.#\n" +
            "#..##..#.#\n" +
            "#.#.###..#\n" +
            "..#..###.#\n" +
            ".#....#..#\n" +
            "##....#.##\n" +
            "..#.#..###\n" +
            "\n" +
            "Tile 2341:\n" +
            "......###.\n" +
            "..#..#....\n" +
            "..#.#...#.\n" +
            "..#.#.###.\n" +
            "...##.#..#\n" +
            "##......#.\n" +
            ".........#\n" +
            "#..#...#..\n" +
            "#.......##\n" +
            "###...#...\n" +
            "\n" +
            "Tile 1609:\n" +
            "..##.#.#..\n" +
            "#.......##\n" +
            "#......#.#\n" +
            "#.......#.\n" +
            "..##...#..\n" +
            "...#.#....\n" +
            "##......#.\n" +
            ".###...#..\n" +
            ".#....#..#\n" +
            "....#####.\n" +
            "\n" +
            "Tile 3299:\n" +
            "#####.####\n" +
            ".##.....#.\n" +
            "..#...#...\n" +
            "...#....#.\n" +
            "#..#.#...#\n" +
            "#...#...##\n" +
            "#.....##.#\n" +
            "....#.##..\n" +
            "##....#...\n" +
            ".##..##.#.\n" +
            "\n" +
            "Tile 1259:\n" +
            "##.#......\n" +
            "........#.\n" +
            ".....#.###\n" +
            "....#.#.##\n" +
            "#.....#.##\n" +
            "..#....#.#\n" +
            "..........\n" +
            ".##.##...#\n" +
            "....##..#.\n" +
            "...#...#..\n" +
            "\n" +
            "Tile 2803:\n" +
            ".#..#.#..#\n" +
            "#...###..#\n" +
            "..###.####\n" +
            "#....#.#.#\n" +
            "##.......#\n" +
            "#.#.#.#...\n" +
            ".#.#.#.#.#\n" +
            "#....#....\n" +
            "....#....#\n" +
            "...###..#.\n" +
            "\n" +
            "Tile 1063:\n" +
            ".#.##.##.#\n" +
            "......#.##\n" +
            ".#..#.##..\n" +
            "#....###..\n" +
            "....###...\n" +
            ".##....#.#\n" +
            "#.#.#....#\n" +
            ".....#..#.\n" +
            "##......##\n" +
            ".######..#\n" +
            "\n" +
            "Tile 2113:\n" +
            "..#.######\n" +
            "####.....#\n" +
            "#.#....##.\n" +
            "........##\n" +
            "#.#.....##\n" +
            "...#.....#\n" +
            "#.........\n" +
            "#.....#..#\n" +
            "##.##.#.##\n" +
            ".##.###.##\n" +
            "\n" +
            "Tile 1531:\n" +
            ".###..#.##\n" +
            "#.....##.#\n" +
            ".......#.#\n" +
            "........##\n" +
            "#.....#...\n" +
            "#.#.#...#.\n" +
            "..#...#..#\n" +
            "##.##.##..\n" +
            "..........\n" +
            "#...#...##\n" +
            "\n" +
            "Tile 1289:\n" +
            "##.###.###\n" +
            "....#..#..\n" +
            "####....##\n" +
            "#.#....#..\n" +
            "#.........\n" +
            "#.#....#.#\n" +
            "...#......\n" +
            ".##.......\n" +
            "##..#.....\n" +
            "...##.####\n" +
            "\n" +
            "Tile 3529:\n" +
            "###..#.#.#\n" +
            "#..###....\n" +
            "....#...##\n" +
            ".#....###.\n" +
            "##...#....\n" +
            "#.##.#.#..\n" +
            "####..#.#.\n" +
            "#....#....\n" +
            "#.##.##..#\n" +
            "#.##.#....\n" +
            "\n" +
            "Tile 2389:\n" +
            ".##.##.#..\n" +
            "#.###...##\n" +
            "..##....##\n" +
            "#.###.#...\n" +
            "#.#......#\n" +
            ".#......##\n" +
            "##..#.#..#\n" +
            "#..#......\n" +
            "..###.....\n" +
            "#.#####..#\n" +
            "\n" +
            "Tile 3727:\n" +
            "#.#.##..#.\n" +
            "##.###.###\n" +
            "#....##...\n" +
            "#....#...#\n" +
            "..##.....#\n" +
            "......#.#.\n" +
            "#.....#...\n" +
            "..........\n" +
            "#..#....##\n" +
            ".#.##.#...\n" +
            "\n" +
            "Tile 1013:\n" +
            "##.#.#####\n" +
            "#.####...#\n" +
            "#..#....#.\n" +
            "#....##...\n" +
            "........##\n" +
            ".#.#.#....\n" +
            "#..#..##..\n" +
            "#.#.#.###.\n" +
            "...##..##.\n" +
            "##.###...#\n" +
            "\n" +
            "Tile 3373:\n" +
            ".##..#.###\n" +
            ".....#....\n" +
            "...#..#...\n" +
            "#...#....#\n" +
            "#..####..#\n" +
            "#...#.##.#\n" +
            ".....##.##\n" +
            "....#.....\n" +
            "...##....#\n" +
            ".#..###...\n" +
            "\n" +
            "Tile 3041:\n" +
            ".#..#.####\n" +
            "..........\n" +
            ".........#\n" +
            "..#.....#.\n" +
            ".....#....\n" +
            "#..#....#.\n" +
            ".......#.#\n" +
            "..#......#\n" +
            "....#..#..\n" +
            "..####..##\n" +
            "\n" +
            "Tile 1627:\n" +
            ".###.#...#\n" +
            "...#..#.##\n" +
            "#...###..#\n" +
            "..#.......\n" +
            "##...##...\n" +
            "#.....####\n" +
            "##........\n" +
            "#..#......\n" +
            "#.##.....#\n" +
            "...#...#.#\n" +
            "\n" +
            "Tile 1297:\n" +
            "#..#...#.#\n" +
            "#.........\n" +
            "..#.#..#..\n" +
            "..#......#\n" +
            ".#..##...#\n" +
            "....#..#.#\n" +
            "#...###...\n" +
            "#...#....#\n" +
            "#..#..#..#\n" +
            "##..#.#..#\n" +
            "\n" +
            "Tile 1787:\n" +
            "####.....#\n" +
            ".....##..#\n" +
            "..........\n" +
            "#...#.....\n" +
            "..........\n" +
            "..#..#.#..\n" +
            "#..#..###.\n" +
            "#......##.\n" +
            "...##..#..\n" +
            "##.....###\n" +
            "\n" +
            "Tile 3109:\n" +
            "##.###..##\n" +
            ".#.#......\n" +
            ".#.......#\n" +
            "#.........\n" +
            "#.#..#.#..\n" +
            "#.#....#..\n" +
            "#.....#..#\n" +
            "........##\n" +
            "##..#....#\n" +
            "##.###..#.\n" +
            "\n" +
            "Tile 3541:\n" +
            ".##.####.#\n" +
            ".....#.#.#\n" +
            "#.........\n" +
            ".#.##...##\n" +
            "..........\n" +
            "#.......##\n" +
            ".#......##\n" +
            ".....###.#\n" +
            "##...##...\n" +
            ".#...#.##.\n" +
            "\n" +
            "Tile 3347:\n" +
            "....##.#.#\n" +
            "..#..#..##\n" +
            ".#..#.##.#\n" +
            "....#.....\n" +
            "....#.....\n" +
            "#.....##.#\n" +
            "#....#....\n" +
            "##....#...\n" +
            ".#.......#\n" +
            "####.##.##\n" +
            "\n" +
            "Tile 1721:\n" +
            "###.#.##.#\n" +
            "##..#.....\n" +
            "#.......#.\n" +
            ".#..##..#.\n" +
            "#.##....##\n" +
            "...#....##\n" +
            "##...#..#.\n" +
            "#.#.#.#...\n" +
            "#.#...#.##\n" +
            "..########\n" +
            "\n" +
            "Tile 1847:\n" +
            "#...##.#.#\n" +
            "..#...#...\n" +
            "##........\n" +
            ".##......#\n" +
            "........##\n" +
            ".#.#.#....\n" +
            ".##.#....#\n" +
            "#..#......\n" +
            ".#..#..###\n" +
            ".#.##..###\n" +
            "\n" +
            "Tile 3329:\n" +
            "###......#\n" +
            "##....#...\n" +
            "#.........\n" +
            "##.#.##.##\n" +
            "#.#.......\n" +
            "..........\n" +
            "##......#.\n" +
            "...#...###\n" +
            "#...#..##.\n" +
            "#......#..\n" +
            "\n" +
            "Tile 3881:\n" +
            ".#.#..##..\n" +
            "##..#...#.\n" +
            ".......#..\n" +
            "#.#..#...#\n" +
            "#.#..#..##\n" +
            "#..##.##.#\n" +
            "#...#..#.#\n" +
            "#..#......\n" +
            "..#...#.#.\n" +
            ".####..###\n" +
            "\n" +
            "Tile 1709:\n" +
            "#####.#.#.\n" +
            ".#.##..###\n" +
            "##..##...#\n" +
            "#####....#\n" +
            "#..#......\n" +
            "....#..#..\n" +
            "#...#.#...\n" +
            "#...#.#...\n" +
            "#..#.....#\n" +
            "#..#.####.\n" +
            "\n" +
            "Tile 1171:\n" +
            "...#.#.#.#\n" +
            "#.....#...\n" +
            "#..#......\n" +
            ".......##.\n" +
            ".....#....\n" +
            "#...#...#.\n" +
            "#........#\n" +
            "#....#....\n" +
            "..#......#\n" +
            "...#.#.#..\n" +
            "\n" +
            "Tile 1499:\n" +
            "########.#\n" +
            "#..#.###.#\n" +
            "...#.###..\n" +
            "#......#.#\n" +
            "###......#\n" +
            "...#......\n" +
            "#...##.#..\n" +
            "....#.#..#\n" +
            "###.#.#...\n" +
            "####.##..#\n" +
            "\n" +
            "Tile 1283:\n" +
            ".##.###.#.\n" +
            "#.........\n" +
            "..#..##.##\n" +
            "....#.....\n" +
            "#.#.##..#.\n" +
            ".##...#..#\n" +
            "#........#\n" +
            "....#...##\n" +
            ".....##..#\n" +
            "#.#.###..#\n" +
            "\n" +
            "Tile 1637:\n" +
            ".#.##.###.\n" +
            "....#.....\n" +
            "#..##.##..\n" +
            ".###...##.\n" +
            "####.....#\n" +
            "##.....#..\n" +
            "#.....##..\n" +
            "#.#.##.#..\n" +
            "#........#\n" +
            "#.#.###.#.\n" +
            "\n" +
            "Tile 3911:\n" +
            "##.###....\n" +
            "#.#.##....\n" +
            ".#...#...#\n" +
            ".#.#.#...#\n" +
            ".#.....#..\n" +
            "##....##..\n" +
            "#.........\n" +
            "..#.#.....\n" +
            "##....#..#\n" +
            "##..###...\n" +
            "\n" +
            "Tile 3259:\n" +
            "...#...#.#\n" +
            "...#..#..#\n" +
            "#.#.###...\n" +
            "#..#...#.#\n" +
            "#....###.#\n" +
            "....#.....\n" +
            ".#....#..#\n" +
            "#........#\n" +
            "#....#..##\n" +
            "##...#.##.\n" +
            "\n" +
            "Tile 2099:\n" +
            "##.##..###\n" +
            ".....#.###\n" +
            "...##..#.#\n" +
            "..#.......\n" +
            ".###.#...#\n" +
            "..##.#.#..\n" +
            "#.#.......\n" +
            "#.##.....#\n" +
            "...#..###.\n" +
            ".##..#.#..\n" +
            "\n" +
            "Tile 1237:\n" +
            ".##..###..\n" +
            "###..#....\n" +
            "#...#.#...\n" +
            "#......#..\n" +
            ".....#..#.\n" +
            "......##..\n" +
            "#...#.....\n" +
            "#.........\n" +
            ".#......##\n" +
            "...##.##..\n" +
            "\n" +
            "Tile 1987:\n" +
            "#..#.#.###\n" +
            "...#...#..\n" +
            "#.#....#.#\n" +
            "..#...#...\n" +
            "....#..##.\n" +
            "#........#\n" +
            ".#.#.#..#.\n" +
            "#....###.#\n" +
            "#.#....#.#\n" +
            "..######.#\n" +
            "\n" +
            "Tile 2539:\n" +
            "##.#...#..\n" +
            "..#..#.##.\n" +
            "#.....#...\n" +
            "#...#.#...\n" +
            ".........#\n" +
            "#.........\n" +
            "......#..#\n" +
            "#......#.#\n" +
            "......#.#.\n" +
            ".#..##....\n" +
            "\n" +
            "Tile 2269:\n" +
            "#.##.#..##\n" +
            "#.......##\n" +
            ".#...#.##.\n" +
            ".##......#\n" +
            ".##.##....\n" +
            "#..#...#..\n" +
            ".#..#...#.\n" +
            "###.....#.\n" +
            "#......###\n" +
            "...#####.#\n" +
            "\n" +
            "Tile 1583:\n" +
            ".##.####.#\n" +
            "...#....##\n" +
            ".........#\n" +
            ".....#...#\n" +
            ".#...##.##\n" +
            "#.....#..#\n" +
            ".#.#.#....\n" +
            "...#..#.#.\n" +
            "#..#.#...#\n" +
            "#.#..#.###\n" +
            "\n" +
            "Tile 2749:\n" +
            ".#..#...#.\n" +
            "....##.###\n" +
            "##...#....\n" +
            "#.#..##.##\n" +
            "#.#..#....\n" +
            ".#.#..#..#\n" +
            "#...#..#..\n" +
            "####..#..#\n" +
            "#.#.#..#.#\n" +
            "#..##.##..\n" +
            "\n" +
            "Tile 1613:\n" +
            "#.#.#.#..#\n" +
            "....#.##.#\n" +
            "....#.....\n" +
            ".#...###.#\n" +
            ".###.##..#\n" +
            "###.#.....\n" +
            "#.#....#.#\n" +
            "..#..#...#\n" +
            "#...#...#.\n" +
            "#.##.####.\n" +
            "\n" +
            "Tile 1823:\n" +
            "...####..#\n" +
            "#....#...#\n" +
            ".....##.#.\n" +
            "....#.#..#\n" +
            ".#..##..##\n" +
            "#####.....\n" +
            "....##....\n" +
            "#....#...#\n" +
            "....#.....\n" +
            "...#.#.#.#\n" +
            "\n" +
            "Tile 3821:\n" +
            ".#####.###\n" +
            "##....##..\n" +
            "##.#.##..#\n" +
            ".##...#..#\n" +
            ".##.....##\n" +
            "...#..#...\n" +
            "......#..#\n" +
            ".....#...#\n" +
            ".#.####.#.\n" +
            "..#.#....#\n" +
            "\n" +
            "Tile 1451:\n" +
            "#..#..###.\n" +
            "###...#...\n" +
            ".......##.\n" +
            ".#......##\n" +
            "#.#.......\n" +
            "...#.....#\n" +
            "#.........\n" +
            "##....##..\n" +
            "#......###\n" +
            "##...###.#\n" +
            "\n" +
            "Tile 1913:\n" +
            "#########.\n" +
            "#........#\n" +
            "#.##..#..#\n" +
            ".###.....#\n" +
            "##.......#\n" +
            "###.......\n" +
            ".....#...#\n" +
            "#...#.....\n" +
            "#.##......\n" +
            "..#.#..###\n" +
            "\n" +
            "Tile 1307:\n" +
            ".#.##.#.#.\n" +
            "#..#..##.#\n" +
            "#.#...#..#\n" +
            "...#..#..#\n" +
            "#...#.....\n" +
            "#...#....#\n" +
            ".......##.\n" +
            "....#.....\n" +
            "...#.#....\n" +
            "##.###.#..\n" +
            "\n" +
            "Tile 1777:\n" +
            "..#..##..#\n" +
            "##....#...\n" +
            "#...#..#..\n" +
            ".##...#..#\n" +
            "###.##.#.#\n" +
            "........##\n" +
            ".....#....\n" +
            "##.....#..\n" +
            "..#..#.#..\n" +
            ".##..##...\n" +
            "\n" +
            "Tile 3011:\n" +
            "#.#..##.#.\n" +
            "#.....#..#\n" +
            ".###...#..\n" +
            "..........\n" +
            "#.....#...\n" +
            "...#.#....\n" +
            "#..#.....#\n" +
            "...#..##.#\n" +
            "#......#.#\n" +
            "...###....\n" +
            "\n" +
            "Tile 2459:\n" +
            "#.##.##.##\n" +
            ".##.#....#\n" +
            ".....#.#.#\n" +
            "#.##...#..\n" +
            ".###.#.#..\n" +
            ".##.......\n" +
            "#.#..#....\n" +
            ".#.....#..\n" +
            "#.#...#.##\n" +
            "#.####.###\n" +
            "\n" +
            "Tile 1123:\n" +
            "....#...##\n" +
            "..###.#.#.\n" +
            "....#.....\n" +
            "#.#..#..##\n" +
            "#.#..#..#.\n" +
            ".#..#.####\n" +
            "....#.###.\n" +
            "#..#.....#\n" +
            "........##\n" +
            ".####.....\n" +
            "\n" +
            "Tile 3917:\n" +
            "##.#.#.###\n" +
            ".........#\n" +
            "........#.\n" +
            ".....#....\n" +
            ".#.....#.#\n" +
            "#.....#.#.\n" +
            "#..#...#..\n" +
            "#.........\n" +
            "#........#\n" +
            "#####..#.#\n" +
            "\n" +
            "Tile 2287:\n" +
            "##.##.###.\n" +
            "##.....###\n" +
            "..#.....#.\n" +
            "#.....#.#.\n" +
            "#..#.#.###\n" +
            ".#...#...#\n" +
            "#..###..#.\n" +
            "#..##.....\n" +
            "###...#..#\n" +
            "#..####.##\n" +
            "\n" +
            "Tile 1471:\n" +
            "#.##...#..\n" +
            ".##.#.#..#\n" +
            "#.......##\n" +
            ".......###\n" +
            "....#.#...\n" +
            "##.......#\n" +
            "#....#...#\n" +
            "#....###..\n" +
            ".##.#.##..\n" +
            "####.#....\n" +
            "\n" +
            "Tile 2357:\n" +
            "####......\n" +
            "..#.......\n" +
            "#.#...#..#\n" +
            "#.........\n" +
            "..........\n" +
            "##..#..#..\n" +
            ".#..###...\n" +
            "..#..##...\n" +
            "##....###.\n" +
            "##...#....\n" +
            "\n" +
            "Tile 1319:\n" +
            "###...###.\n" +
            "..#..#....\n" +
            "#..#.....#\n" +
            "......#.##\n" +
            ".........#\n" +
            "...#....#.\n" +
            "###..#...#\n" +
            "###..##..#\n" +
            "....##.#..\n" +
            "#...#.....\n" +
            "\n" +
            "Tile 3467:\n" +
            "..#...#...\n" +
            ".#.....#.#\n" +
            "..#......#\n" +
            "..#......#\n" +
            "#..#....#.\n" +
            ".#....#.#.\n" +
            "##..#.....\n" +
            "###....#..\n" +
            "#.....##..\n" +
            "##...#...#\n" +
            "\n" +
            "Tile 3407:\n" +
            ".###..####\n" +
            "#....#...#\n" +
            "#.........\n" +
            "..#....#.#\n" +
            "..#.....##\n" +
            ".#.....#.#\n" +
            "..#.#..#..\n" +
            "#..#.##...\n" +
            ".#....##..\n" +
            ".#####.###\n" +
            "\n" +
            "Tile 2801:\n" +
            "#..##..##.\n" +
            "..#.....##\n" +
            ".....#....\n" +
            "..#...##..\n" +
            "#.#....#.#\n" +
            "#....#.#.#\n" +
            "..#...#.##\n" +
            "#.#..##..#\n" +
            "#...#.#..#\n" +
            "##.....#.#\n" +
            "\n" +
            "Tile 1021:\n" +
            "......#.#.\n" +
            "...#...#..\n" +
            "#.#......#\n" +
            "##..#..#.#\n" +
            "##..#.....\n" +
            "..#..#..#.\n" +
            "......##.#\n" +
            "......##..\n" +
            "..##......\n" +
            "##....#...\n" +
            "\n" +
            "Tile 3677:\n" +
            "#.#.......\n" +
            "#...#.##.#\n" +
            "....#..#.#\n" +
            ".#...#....\n" +
            "..........\n" +
            ".........#\n" +
            "..#..#.#.#\n" +
            "#.#.##...#\n" +
            "..##.....#\n" +
            "#.##.##.##\n" +
            "\n" +
            "Tile 1321:\n" +
            ".#.#...#.#\n" +
            "#..##...##\n" +
            "#.#.....#.\n" +
            "###.......\n" +
            "#........#\n" +
            ".#..#....#\n" +
            "#.##.##...\n" +
            "#.#....##.\n" +
            ".##.....##\n" +
            "#.#####...\n" +
            "\n" +
            "Tile 1607:\n" +
            "....###..#\n" +
            "..#...#...\n" +
            ".#.......#\n" +
            "#...#.....\n" +
            "...#......\n" +
            "#.........\n" +
            "#...#.....\n" +
            "........##\n" +
            "##...#...#\n" +
            "#....#.#.#\n" +
            "\n" +
            "Tile 1979:\n" +
            "##.#.#....\n" +
            ".#..#...##\n" +
            "#.......#.\n" +
            "..........\n" +
            "..#...#...\n" +
            ".....#...#\n" +
            ".........#\n" +
            "...#..###.\n" +
            ".###......\n" +
            "#####..#..\n" +
            "\n" +
            "Tile 2927:\n" +
            "#.##..###.\n" +
            "#.#......#\n" +
            "......#...\n" +
            "...#....##\n" +
            "#....##...\n" +
            "##.......#\n" +
            "#..#..#...\n" +
            "....#..#..\n" +
            "#...#.#..#\n" +
            "#.###.....\n" +
            "\n" +
            "Tile 3203:\n" +
            "#.#..#..#.\n" +
            ".#.#......\n" +
            "....##..#.\n" +
            "....######\n" +
            "#........#\n" +
            "..#......#\n" +
            "##.#...#..\n" +
            "#......#.#\n" +
            "#.....#.##\n" +
            ".##..###.#\n" +
            "\n" +
            "Tile 3323:\n" +
            "##..###.#.\n" +
            ".......#.#\n" +
            ".........#\n" +
            "#.........\n" +
            "........#.\n" +
            ".........#\n" +
            "###......#\n" +
            "..........\n" +
            "#...#.#..#\n" +
            ".##.#.###.\n" +
            "\n" +
            "Tile 1489:\n" +
            ".#...##.#.\n" +
            "........##\n" +
            ".##.#...##\n" +
            ".......#.#\n" +
            "#.##.#.#.#\n" +
            ".##....##.\n" +
            "#....#..#.\n" +
            "#..#.....#\n" +
            "##.#.##.##\n" +
            ".#.#.#....\n" +
            "\n" +
            "Tile 2273:\n" +
            "####.#..#.\n" +
            "##.#......\n" +
            "##..###.##\n" +
            ".##..#....\n" +
            "#..#.#...#\n" +
            "##...#....\n" +
            "#.#...#.#.\n" +
            "#..#.....#\n" +
            "##.#..#.#.\n" +
            "##...#..#.\n" +
            "\n" +
            "Tile 2293:\n" +
            ".#.##.#...\n" +
            "..#.#.#.#.\n" +
            ".......###\n" +
            "#.#....#..\n" +
            "#......#.#\n" +
            "##..##.#.#\n" +
            "######..##\n" +
            "#.....#...\n" +
            "##....#..#\n" +
            "#.#####.##\n" +
            "\n" +
            "Tile 1301:\n" +
            "#.....##..\n" +
            "#..#.....#\n" +
            "#......#.#\n" +
            "#....#....\n" +
            "##.#.#..##\n" +
            "......#...\n" +
            "#.........\n" +
            "#........#\n" +
            "#..#.....#\n" +
            "###..##...\n" +
            "\n" +
            "Tile 1229:\n" +
            ".#..####..\n" +
            "##.....##.\n" +
            "##........\n" +
            "#...#.....\n" +
            ".#....#.#.\n" +
            "#.........\n" +
            "..#......#\n" +
            "##..##.#.#\n" +
            "#####....#\n" +
            "#..#.###..\n" +
            "\n" +
            "Tile 3769:\n" +
            ".#..#.##.#\n" +
            "##.....#.#\n" +
            "#.#...#..#\n" +
            "..#..##..#\n" +
            "#.##.#####\n" +
            ".....##.#.\n" +
            "#.#.####..\n" +
            ".###...#..\n" +
            "#.#...#..#\n" +
            ".#.####...\n" +
            "\n" +
            "Tile 3319:\n" +
            "######.###\n" +
            "....#...##\n" +
            "#..##..#.#\n" +
            "##.....#..\n" +
            "#.#.##..#.\n" +
            "#.#.#.....\n" +
            ".........#\n" +
            "#.#.#..###\n" +
            "....#..#.#\n" +
            "####....#.\n" +
            "\n" +
            "Tile 3547:\n" +
            "##..#..##.\n" +
            "#.....#...\n" +
            ".#.......#\n" +
            ".......#.#\n" +
            "#.....#..#\n" +
            "#..##.#.#.\n" +
            "....#.#...\n" +
            "....#..#..\n" +
            ".....#....\n" +
            "...#.#..##\n" +
            "\n" +
            "Tile 3643:\n" +
            "....####.#\n" +
            "...#......\n" +
            ".##......#\n" +
            "#...#.....\n" +
            ".......##.\n" +
            "##.......#\n" +
            "......##.#\n" +
            "#.....#...\n" +
            "#.#.......\n" +
            "######...#\n" +
            "\n" +
            "Tile 1103:\n" +
            "#...#.#.#.\n" +
            ".........#\n" +
            ".....#....\n" +
            ".......#..\n" +
            "#......###\n" +
            "##......##\n" +
            "#..#.....#\n" +
            "#.#.....#.\n" +
            "#...#...##\n" +
            ".#.#...#.#\n" +
            "\n" +
            "Tile 2711:\n" +
            "###.##.##.\n" +
            "....#...#.\n" +
            "##.......#\n" +
            "#.....#...\n" +
            "#...#.#.##\n" +
            "#..##.#...\n" +
            "..#....###\n" +
            "...#....##\n" +
            ".##.#####.\n" +
            ".##.##.#.#\n" +
            "\n" +
            "Tile 1871:\n" +
            "#.###.####\n" +
            ".........#\n" +
            "#......#.#\n" +
            "..##....##\n" +
            "#..#..##.#\n" +
            "#..###...#\n" +
            "#.#.....##\n" +
            "......#.#.\n" +
            ".#.#.....#\n" +
            "#.#.#.....\n" +
            "\n" +
            "Tile 3851:\n" +
            "..##.##.#.\n" +
            ".....#.#..\n" +
            "#....#...#\n" +
            "#..#..#..#\n" +
            "###.....#.\n" +
            "#.#..#..##\n" +
            "..#......#\n" +
            ".##.#....#\n" +
            "#....##.#.\n" +
            ".##..#.#.#\n" +
            "\n" +
            "Tile 1151:\n" +
            "###......#\n" +
            "...##.....\n" +
            "....#.....\n" +
            "....#.....\n" +
            "#..#..#...\n" +
            "##....##..\n" +
            "..#......#\n" +
            ".#.....#.#\n" +
            "........##\n" +
            ".##.#..#.#\n" +
            "\n" +
            "Tile 2377:\n" +
            ".##.##.#.#\n" +
            ".....##.##\n" +
            "###.......\n" +
            "#....##..#\n" +
            "##......#.\n" +
            "...#.##..#\n" +
            "#...#....#\n" +
            ".##..#.##.\n" +
            "#.###...#.\n" +
            ".#.#..##..\n" +
            "\n" +
            "Tile 3581:\n" +
            "..#.#....#\n" +
            "..#.#..#..\n" +
            ".##..#.##.\n" +
            "#.##..##..\n" +
            "#.....#...\n" +
            "#..#...###\n" +
            "...#......\n" +
            "#.#.......\n" +
            "####......\n" +
            "#.#...####\n" +
            "\n" +
            "Tile 1303:\n" +
            "##.#.#....\n" +
            "#.#.#.##.#\n" +
            "..#......#\n" +
            ".##.##...#\n" +
            "##..#..#..\n" +
            "#...#.#.##\n" +
            "##..#.#..#\n" +
            "..##.#....\n" +
            "#.........\n" +
            ".#.#..##.#\n" +
            "\n" +
            "Tile 2843:\n" +
            "##.##..##.\n" +
            "#..##.##.#\n" +
            "#...#....#\n" +
            "#..#.####.\n" +
            "#...#.....\n" +
            "##....#..#\n" +
            "#...#.....\n" +
            "..#..###..\n" +
            "#..#..#..#\n" +
            "##..##...#\n" +
            "\n" +
            "Tile 3617:\n" +
            "##...##..#\n" +
            ".#..#...#.\n" +
            ".##......#\n" +
            "#.####...#\n" +
            "##........\n" +
            "#.........\n" +
            "#......#..\n" +
            "##...#....\n" +
            "#.##..#..#\n" +
            ".##..##...\n" +
            "\n" +
            "Tile 1091:\n" +
            "######..#.\n" +
            "....#.#..#\n" +
            ".....#...#\n" +
            "#....#...#\n" +
            "......#.##\n" +
            "...#.##...\n" +
            "#...#.....\n" +
            "..#.###...\n" +
            "#....#..##\n" +
            "#.###..#..\n" +
            "\n" +
            "Tile 1213:\n" +
            ".##..#.#.#\n" +
            ".#..#..#..\n" +
            "##.#.#....\n" +
            "#....##..#\n" +
            "##........\n" +
            "##..#.....\n" +
            "#...#..#..\n" +
            "#...#..#..\n" +
            "#.......#.\n" +
            "#.....#.##";

    private static final String INPUT2 = "Tile 2311:\n" +
            "..##.#..#.\n" +
            "##..#.....\n" +
            "#...##..#.\n" +
            "####.#...#\n" +
            "##.##.###.\n" +
            "##...#.###\n" +
            ".#.#.#..##\n" +
            "..#....#..\n" +
            "###...#.#.\n" +
            "..###..###\n" +
            "\n" +
            "Tile 1951:\n" +
            "#.##...##.\n" +
            "#.####...#\n" +
            ".....#..##\n" +
            "#...######\n" +
            ".##.#....#\n" +
            ".###.#####\n" +
            "###.##.##.\n" +
            ".###....#.\n" +
            "..#.#..#.#\n" +
            "#...##.#..\n" +
            "\n" +
            "Tile 1171:\n" +
            "####...##.\n" +
            "#..##.#..#\n" +
            "##.#..#.#.\n" +
            ".###.####.\n" +
            "..###.####\n" +
            ".##....##.\n" +
            ".#...####.\n" +
            "#.##.####.\n" +
            "####..#...\n" +
            ".....##...\n" +
            "\n" +
            "Tile 1427:\n" +
            "###.##.#..\n" +
            ".#..#.##..\n" +
            ".#.##.#..#\n" +
            "#.#.#.##.#\n" +
            "....#...##\n" +
            "...##..##.\n" +
            "...#.#####\n" +
            ".#.####.#.\n" +
            "..#..###.#\n" +
            "..##.#..#.\n" +
            "\n" +
            "Tile 1489:\n" +
            "##.#.#....\n" +
            "..##...#..\n" +
            ".##..##...\n" +
            "..#...#...\n" +
            "#####...#.\n" +
            "#..#.#.#.#\n" +
            "...#.#.#..\n" +
            "##.#...##.\n" +
            "..##.##.##\n" +
            "###.##.#..\n" +
            "\n" +
            "Tile 2473:\n" +
            "#....####.\n" +
            "#..#.##...\n" +
            "#.##..#...\n" +
            "######.#.#\n" +
            ".#...#.#.#\n" +
            ".#########\n" +
            ".###.#..#.\n" +
            "########.#\n" +
            "##...##.#.\n" +
            "..###.#.#.\n" +
            "\n" +
            "Tile 2971:\n" +
            "..#.#....#\n" +
            "#...###...\n" +
            "#.#.###...\n" +
            "##.##..#..\n" +
            ".#####..##\n" +
            ".#..####.#\n" +
            "#..#.#..#.\n" +
            "..####.###\n" +
            "..#.#.###.\n" +
            "...#.#.#.#\n" +
            "\n" +
            "Tile 2729:\n" +
            "...#.#.#.#\n" +
            "####.#....\n" +
            "..#.#.....\n" +
            "....#..#.#\n" +
            ".##..##.#.\n" +
            ".#.####...\n" +
            "####.#.#..\n" +
            "##.####...\n" +
            "##..#.##..\n" +
            "#.##...##.\n" +
            "\n" +
            "Tile 3079:\n" +
            "#.#.#####.\n" +
            ".#..######\n" +
            "..#.......\n" +
            "######....\n" +
            "####.#..#.\n" +
            ".#...#.##.\n" +
            "#.#####.##\n" +
            "..#.###...\n" +
            "..#.......\n" +
            "..#.###...";

    private static class Tile {
        long id;
        List<List<String>> cells;

        public Tile(long id, List<List<String>> cells) {
            this.id = id;
            this.cells = cells;
        }

        @Override
        public boolean equals(Object o) {
            if (this == o) return true;
            if (o == null || getClass() != o.getClass()) return false;
            Tile tile = (Tile) o;
            return id == tile.id && cells.equals(tile.cells);
        }

        @Override
        public int hashCode() {
            return Objects.hash(id, cells);
        }

        private String drawString() {
            StringBuilder sb = new StringBuilder();
            for (List<String> row : cells) {
                sb.append(StringUtils.join(row, ""));
                sb.append("\n");
            }
            return sb.toString();
        }

        @Override
        public String toString() {
            return "Tile{" +
                    "id=" + id + "\n" +
                    drawString() +
                    '}';
        }
    }

    public static void main(String[] args) {
        List<Tile> tiles = new ArrayList<>();

        String[] rawTiles = INPUT.split("\n\n");
        for (int i = 0; i < rawTiles.length; i++) {
            String[] lines = rawTiles[i].split("\n");
            long id = Long.parseLong(lines[0].split(" ")[1].replace(":", ""));
            List<List<String>> cells = new ArrayList<>();
            for (int j = 1; j < lines.length; j++) {
                List<String> row = new ArrayList<>();
                for (int k = 0; k < lines[j].length(); k++) {
                    row.add(Character.toString(lines[j].charAt(k)));
                }
                cells.add(row);
            }
            tiles.add(new Tile(id, cells));
        }

//        Tile t1 = tiles.get(0);
//        Tile r1 = rotate(t1);
//        Tile r2 = rotate(r1);
//        Tile r3 = rotate(r2);
//        Tile r4 = rotate(r3);
//        System.out.println(t1.equals(r1));
//        System.out.println(t1.equals(r4));
//        System.out.println(t1);
//        System.out.println(r1);
//        System.out.println(r2);
//        System.out.println(r3);
//        System.out.println(r4);

//        Tile fh1 = flipHorizontal(t1);
//        Tile fh2 = flipHorizontal(fh1);
//        System.out.println(t1.equals(fh1));
//        System.out.println(t1.equals(fh2));
//        System.out.println(fh1);
//
//        Tile fv1 = flipVertical(t1);
//        Tile fv2 = flipVertical(fv1);
//        System.out.println(t1.equals(fv1));
//        System.out.println(t1.equals(fv2));
//        System.out.println(fv1);
//
//        Set<Tile> tileSet = new HashSet<>();
//        tileSet.add(t1);
//        tileSet.add(r1);
//        tileSet.add(r2);
//        tileSet.add(r3);
//        tileSet.add(r4);
//        tileSet.add(fh1);
//        tileSet.add(fh2);
//        tileSet.add(fv1);
//        tileSet.add(fv2);
//        System.out.println(tileSet.size());

//        System.out.println((int)Math.sqrt(tiles.size()));
        int imageSize = (int)Math.sqrt(tiles.size());
        Tile[][] image = new Tile[imageSize][imageSize];

        List<Tile> cornerTiles = new ArrayList<>();
        List<Tile> otherTiles = new ArrayList<>();
        Set<Long> cornerTileIds = Day20Part1.getCornerTileIds();
        for (Tile tile : tiles) {
            if (cornerTileIds.contains(tile.id)) {
                cornerTiles.add(tile);
            } else {
                otherTiles.add(tile);
            }
        }

        boolean foundImage = findFullImage(image, 0, 0, otherTiles, cornerTiles, new HashSet<>());
        if (!foundImage) {
            System.out.println("Image not found.");
            System.exit(0);
        }
        for (int row = 0; row < imageSize; row++) {
            for (int col = 0; col < imageSize; col++) {
                System.out.println(image[row][col]);
            }
        }

        long part1Res = image[0][0].id * image[0][imageSize-1].id * image[imageSize-1][0].id *
                image[imageSize-1][imageSize-1].id;
        System.out.println(part1Res);

        List<List<String>> fullCells = new ArrayList<>();
        for (int row = 0; row < imageSize; row++) {
            List<List<String>> cells = new ArrayList<>();
            for (int col = 0; col < imageSize; col++) {
                Tile tile = cutBorders(image[row][col]);
                if (cells.isEmpty()) {
                    cells.addAll(tile.cells);
                } else {
                    for (int i = 0; i < tile.cells.size(); i++) {
                        cells.get(i).addAll(tile.cells.get(i));
                    }
                }
            }
            fullCells.addAll(cells);
        }
        Tile fullTile = new Tile(1L, fullCells);
        System.out.println(fullTile);

        String monster = "                  # \n" +
                "#    ##    ##    ###\n" +
                " #  #  #  #  #  #   ";
        String[] monsterLines = monster.split("\n");
        List<Offset> monsterOffsets = new ArrayList<>();
        for (int row = 0; row < monsterLines.length; row++) {
            for (int col = 0; col < monsterLines[row].length(); col++) {
                if (monsterLines[row].charAt(col) == '#') {
                    monsterOffsets.add(new Offset(row, col));
                }
            }
        }

        if (findMonster(fullTile, monsterOffsets)) {
            System.out.println(getRoughWaterCount(fullTile, monsterOffsets));
            System.exit(0);
        }
        Tile rt = rotate(fullTile);
        if (findMonster(rt, monsterOffsets)) {
            System.out.println(getRoughWaterCount(rt, monsterOffsets));
            System.exit(0);
        }
        Tile fh1 = flipHorizontal(rt);
        if (findMonster(fh1, monsterOffsets)) {
            System.out.println(getRoughWaterCount(fh1, monsterOffsets));
            System.exit(0);
        }
        Tile fv1 = flipVertical(rt);
        if (findMonster(fv1, monsterOffsets)) {
            System.out.println(getRoughWaterCount(fv1, monsterOffsets));
            System.exit(0);
        }
        rt = rotate(rt);
        if (findMonster(rt, monsterOffsets)) {
            System.out.println(getRoughWaterCount(rt, monsterOffsets));
            System.exit(0);
        }
        Tile fh2 = flipHorizontal(rt);
        if (findMonster(fh2, monsterOffsets)) {
            System.out.println(getRoughWaterCount(fh2, monsterOffsets));
            System.exit(0);
        }
        Tile fv2 = flipVertical(rt);
        if (findMonster(fv2, monsterOffsets)) {
            System.out.println(getRoughWaterCount(fv2, monsterOffsets));
            System.exit(0);
        }
        rt = rotate(rt);
        if (findMonster(rt, monsterOffsets)) {
            System.out.println(getRoughWaterCount(rt, monsterOffsets));
            System.exit(0);
        }
        Tile fh3 = flipHorizontal(rt);
        if (findMonster(fh3, monsterOffsets)) {
            System.out.println(getRoughWaterCount(fh3, monsterOffsets));
            System.exit(0);
        }
        Tile fv3 = flipVertical(rt);
        if (findMonster(fv3, monsterOffsets)) {
            System.out.println(getRoughWaterCount(fv3, monsterOffsets));
            System.exit(0);
        }
        Tile fh = flipHorizontal(fullTile);
        if (findMonster(fh, monsterOffsets)) {
            System.out.println(getRoughWaterCount(fh, monsterOffsets));
            System.exit(0);
        }
        Tile fv = flipVertical(fullTile);
        if (findMonster(fv, monsterOffsets)) {
            System.out.println(getRoughWaterCount(fv, monsterOffsets));
            System.exit(0);
        }
    }

    private static boolean findMonster(Tile fullTile, List<Offset> monsterOffsets) {
        for (int row = 0; row < fullTile.cells.size(); row++) {
            for (int col = 0; col < fullTile.cells.get(row).size(); col++) {
                boolean found = true;
                for (Offset offset : monsterOffsets) {
                    if (row+offset.rowOffset >= fullTile.cells.size() ||
                            col+offset.colOffset >= fullTile.cells.get(row).size() ||
                            !fullTile.cells.get(row+offset.rowOffset).get(col+offset.colOffset).equals("#")) {
                        found = false;
                        break;
                    }
                }
                if (found) {
                    return true;
                }
            }
        }
        return false;
    }

    private static int getRoughWaterCount(Tile fullTile, List<Offset> monsterOffsets) {
        for (int row = 0; row < fullTile.cells.size(); row++) {
            for (int col = 0; col < fullTile.cells.get(row).size(); col++) {
                boolean found = true;
                for (Offset offset : monsterOffsets) {
                    if (row+offset.rowOffset >= fullTile.cells.size() ||
                            col+offset.colOffset >= fullTile.cells.get(row).size() ||
                            !fullTile.cells.get(row+offset.rowOffset).get(col+offset.colOffset).equals("#")) {
                        found = false;
                        break;
                    }
                }
                if (found) {
                    for (Offset offset : monsterOffsets) {
                        fullTile.cells.get(row+offset.rowOffset).set(col+offset.colOffset, "O");
                    }
                }
            }
        }
        int res = 0;
        for (int row = 0; row < fullTile.cells.size(); row++) {
            for (int col = 0; col < fullTile.cells.get(row).size(); col++) {
                if (fullTile.cells.get(row).get(col).equals("#")) {
                    res++;
                }
            }
        }
        return res;
    }

    private static class Offset {
        int rowOffset;
        int colOffset;

        public Offset(int rowOffset, int colOffset) {
            this.rowOffset = rowOffset;
            this.colOffset = colOffset;
        }
    }

    private static boolean findFullImage(Tile[][] image, int col, int row, List<Tile> tiles, List<Tile> cornerTiles,
                                         Set<Tile> usedTiles) {
        if (tiles.size() + cornerTiles.size() == usedTiles.size()) {
            return true;
        }
        if ((col == 0 && row == 0) ||
                (col == image.length-1 && row == 0) ||
                (col == 0 && row == image.length-1) ||
                (col == image.length-1 && row == image.length-1)) {
            for (Tile tile : cornerTiles) {
                if (!usedTiles.contains(tile)) {
                    if (tryTile(image, col, row, tiles, cornerTiles, usedTiles, tile, tile)) {
                        return true;
                    }
                    Tile rt = rotate(tile);
                    if (tryTile(image, col, row, tiles, cornerTiles, usedTiles, rt, tile)) {
                        return true;
                    }
                    Tile fh1 = flipHorizontal(rt);
                    if (tryTile(image, col, row, tiles, cornerTiles, usedTiles, fh1, tile)) {
                        return true;
                    }
                    Tile fv1 = flipVertical(rt);
                    if (tryTile(image, col, row, tiles, cornerTiles, usedTiles, fv1, tile)) {
                        return true;
                    }
                    rt = rotate(rt);
                    if (tryTile(image, col, row, tiles, cornerTiles, usedTiles, rt, tile)) {
                        return true;
                    }
                    Tile fh2 = flipHorizontal(rt);
                    if (tryTile(image, col, row, tiles, cornerTiles, usedTiles, fh2, tile)) {
                        return true;
                    }
                    Tile fv2 = flipVertical(rt);
                    if (tryTile(image, col, row, tiles, cornerTiles, usedTiles, fv2, tile)) {
                        return true;
                    }
                    rt = rotate(rt);
                    if (tryTile(image, col, row, tiles, cornerTiles, usedTiles, rt, tile)) {
                        return true;
                    }
                    Tile fh3 = flipHorizontal(rt);
                    if (tryTile(image, col, row, tiles, cornerTiles, usedTiles, fh3, tile)) {
                        return true;
                    }
                    Tile fv3 = flipVertical(rt);
                    if (tryTile(image, col, row, tiles, cornerTiles, usedTiles, fv3, tile)) {
                        return true;
                    }
                    Tile fh = flipHorizontal(tile);
                    if (tryTile(image, col, row, tiles, cornerTiles, usedTiles, fh, tile)) {
                        return true;
                    }
                    Tile fv = flipVertical(tile);
                    if (tryTile(image, col, row, tiles, cornerTiles, usedTiles, fv, tile)) {
                        return true;
                    }
                }
            }
        } else {
            for (Tile tile : tiles) {
                if (!usedTiles.contains(tile)) {
                    if (tryTile(image, col, row, tiles, cornerTiles, usedTiles, tile, tile)) {
                        return true;
                    }
                    Tile rt = rotate(tile);
                    if (tryTile(image, col, row, tiles, cornerTiles, usedTiles, rt, tile)) {
                        return true;
                    }
                    Tile fh1 = flipHorizontal(rt);
                    if (tryTile(image, col, row, tiles, cornerTiles, usedTiles, fh1, tile)) {
                        return true;
                    }
                    Tile fv1 = flipVertical(rt);
                    if (tryTile(image, col, row, tiles, cornerTiles, usedTiles, fv1, tile)) {
                        return true;
                    }
                    rt = rotate(rt);
                    if (tryTile(image, col, row, tiles, cornerTiles, usedTiles, rt, tile)) {
                        return true;
                    }
                    Tile fh2 = flipHorizontal(rt);
                    if (tryTile(image, col, row, tiles, cornerTiles, usedTiles, fh2, tile)) {
                        return true;
                    }
                    Tile fv2 = flipVertical(rt);
                    if (tryTile(image, col, row, tiles, cornerTiles, usedTiles, fv2, tile)) {
                        return true;
                    }
                    rt = rotate(rt);
                    if (tryTile(image, col, row, tiles, cornerTiles, usedTiles, rt, tile)) {
                        return true;
                    }
                    Tile fh3 = flipHorizontal(rt);
                    if (tryTile(image, col, row, tiles, cornerTiles, usedTiles, fh3, tile)) {
                        return true;
                    }
                    Tile fv3 = flipVertical(rt);
                    if (tryTile(image, col, row, tiles, cornerTiles, usedTiles, fv3, tile)) {
                        return true;
                    }
                    Tile fh = flipHorizontal(tile);
                    if (tryTile(image, col, row, tiles, cornerTiles, usedTiles, fh, tile)) {
                        return true;
                    }
                    Tile fv = flipVertical(tile);
                    if (tryTile(image, col, row, tiles, cornerTiles, usedTiles, fv, tile)) {
                        return true;
                    }
                }
            }
        }
        return false;
    }

    private static boolean tryTile(Tile[][] image, int col, int row, List<Tile> tiles, List<Tile> cornerTiles,
                                   Set<Tile> usedTiles, Tile tile, Tile origTile) {
        if (fits(image, col, row, tile)) {
            image[row][col] = tile;
            usedTiles.add(origTile);
            int nextCol;
            int nextRow;
            if (col == image.length-1) {
                nextCol = 0;
                nextRow = row + 1;
            } else {
                nextCol = col + 1;
                nextRow = row;
            }
            if (findFullImage(image, nextCol, nextRow, tiles, cornerTiles, usedTiles)) {
                return true;
            }
            image[row][col] = null;
            usedTiles.remove(origTile);
        }
        return false;
    }

    private static boolean fits(Tile[][] image, int col, int row, Tile tile) {
        // left
        if (col > 0 && image[row][col-1] != null) {
            Tile leftTile = image[row][col-1];
            for (int i = 0; i < leftTile.cells.size(); i++) {
                List<String> leftRow = leftTile.cells.get(i);
                List<String> rightRow = tile.cells.get(i);
                if (!leftRow.get(leftRow.size()-1).equals(rightRow.get(0))) {
                    return false;
                }
            }
        }
        // right
        if (col < image.length-1 && image[row][col+1] != null) {
            throw new IllegalStateException("checking right");
        }
        // up
        if (row > 0 && image[row-1][col] != null) {
            Tile upTile = image[row-1][col];
            List<String> upRow = upTile.cells.get(upTile.cells.size()-1);
            List<String> downRow = tile.cells.get(0);
            if (!upRow.equals(downRow)) {
                return false;
            }
        }
        // down
        if (row < image.length-1 && image[row+1][col] != null) {
            throw new IllegalStateException("checking down");
        }
        return true;
    }

    /*
    1 2
    3 4

    3 1
    4 2
     */
    private static Tile rotate(Tile tile) {
        List<List<String>> newCells = new ArrayList<>();
        for (int i = 0; i < tile.cells.get(0).size(); i++) {
            List<String> newRow = new ArrayList<>();
            for (List<String> row : tile.cells) {
                newRow.add(row.get(i));
            }
            Collections.reverse(newRow);
            newCells.add(newRow);
        }
        return new Tile(tile.id, newCells);
    }

    private static Tile flipHorizontal(Tile tile) {
        List<List<String>> newCells = new ArrayList<>();
        for (List<String> row : tile.cells) {
            List<String> newRow = new ArrayList<>(row);
            Collections.reverse(newRow);
            newCells.add(newRow);
        }
        return new Tile(tile.id, newCells);
    }

    private static Tile flipVertical(Tile tile) {
        List<List<String>> newCells = new ArrayList<>();
        for (List<String> row : tile.cells) {
            newCells.add(new ArrayList<>(row));
        }
        for (int i = 0; i < tile.cells.get(0).size(); i++) {
            List<String> newRow = new ArrayList<>();
            for (List<String> row : tile.cells) {
                newRow.add(row.get(i));
            }
            Collections.reverse(newRow);
            int j = 0;
            for (List<String> row : newCells) {
                newRow.add(row.set(i, newRow.get(j++)));
            }
        }
        return new Tile(tile.id, newCells);
    }

    private static Tile cutBorders(Tile tile) {
        List<List<String>> newCells = new ArrayList<>();
        for (int i = 1; i < tile.cells.size()-1; i++) {
            List<String> row = tile.cells.get(i);
            newCells.add(new ArrayList<>(row.subList(1, row.size()-1)));
        }
        return new Tile(tile.id, newCells);
    }
}
